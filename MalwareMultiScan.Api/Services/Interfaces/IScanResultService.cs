using System.IO;
using System.Threading.Tasks;
using MalwareMultiScan.Api.Data.Models;

namespace MalwareMultiScan.Api.Services.Interfaces
{
    public interface IScanResultService
    { 
        Task<ScanResult> CreateScanResult();
        
        Task<ScanResult> GetScanResult(string id);

        Task UpdateScanResultForBackend(string resultId, string backendId, long duration,
            bool completed = false, bool succeeded = false, string[] threats = null);

        Task QueueUrlScan(ScanResult result, string fileUrl);

        Task<string> StoreFile(string fileName, Stream fileStream);

        Task<Stream> ObtainFile(string id);
    }
}